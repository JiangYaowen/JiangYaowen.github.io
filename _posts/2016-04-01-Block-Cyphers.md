---
layout: post
title: 分组加密
date: 2016-04-07
categories: blog
tags: [加密与安全]
description: 分组加密概念及分类

---


## 分组加密
### 概念明析
加密一般分为对称加密(Symmetric Key Encryption)和非对称加密(Asymmetric Key Encryption)。

**对称加密**又分为**分组加密**和**序列密码**。

**分组密码**，也叫**块加密(block cyphers)**，一次加密明文中的一个块。是将明文按一定的位长分组，明文组经过加密运算得到密文组，密文组经过解密运算（加密运算的逆运算），还原成明文组。

**序列密码**，也叫**流加密(stream cyphers)**，一次加密明文中的一个位。是指利用少量的密钥（制乱元素）通过某种复杂的运算（密码算法）产生大量的伪随机位流，用于对明文位流的加密。
解密是指用同样的密钥和密码算法及与加密相同的伪随机位流，用以还原明文位流。

在分组加密算法中，有ECB,CBC,CFB,OFB这几种算法模式。

### 1电子编码本模式ECB(Electronic Code Book）
最简单的一种算法模式，在这种模式下，待加密的明文被划分为等长的分组（block），常见的分组长度为64比特或128比特，对每一个这样的分组，使用相同的密匙进行独立的加密。

信息接受者在接收到密文后，以同样的长度对密文进行分组，再使用和加密过程中相同的密匙进行解密，即可恢复明文。

该模式下，内容相同的明文分组永远被加密成内容相同的密文分组，反之亦然，所以理论上可以构造一个由明文分组及其对应的密文分组构成的电子编码本，这也是这种模式名字的由来，假设分组长度为128比特，那么电子密码本中最多可包含2128项。每一个不同的密钥都对应着一个不同 的电子编码本。

ECB模式的优点是易于实现，每一个明文分组可被独立地乱序加密，不必按照原文顺序进行。但由于对所有的明文分组使用相同的密钥进行加密，相同的明文分组被加密为相同的密文分组，这就为攻击者提供了蛛丝马迹，特别在明文较长，分组数目较多，同一分组重复出现概率较高的情况下尤为明显。所以ECB模式只适用于加密分组少、分组重复出现概率低的短明文。
### 2)密码分组链接CBC(Cipher Block Chaining)
CBC模式保证了即使在明文中同一分组多次重复出现，这些相同的明文分组也将被加密为各不相同的密文分组，从而克服ECB模式中固定分组映射和分组重复所带来的隐患。

为了达到这一目标，在CBC模式中引入了一种被称为反馈(Feedback)的安全性增强机制：前一个明文分组的加密结果被反馈到(链接)当前分组的加密过程中，换句话说，就是每一个分组的加密结果都被用来调整和修正对下一个分组的加密。每个密文分组不仅仅依赖于产生它的明文分组，还依赖于它前面的所有明文分组。

在CBC模式中，一个明文分组被加密后，其结果被存储在反馈寄存器中，在下一个明文分组被加密之前，将反馈寄存器中的内容与待加密的明文分组进行异或运算，运算的结果作为下一次加密的输入，其结果又被存储在反馈寄存器中，再与下一个明文分组进行异或运算，依此类推，直至整个明文加密结束。

解密时，一个密文分组被解密，该密文分组被存储在反馈寄存器中，在下一个密文分组被解密后，将解密结果与反馈寄存器中的内容进行异或运算，接着下一个密文分组又存储在反馈寄存器中，依此类推，直至整个密文解密结束。

CBC模式可以保证属于同一明文的、内容相同的分组被加密为各不相同的密文分组，但是两个内容部分或全部相同的明文仍有可能被加密为相同的密文。

为了避免发生此种情况，我们在对第一个明文分组进行加密时引入一个被称为初始化向量(Initialization Vector，IV)的随机数据。初始化向量本身并没有任何特殊含义，它的作用就是使每一个明文独一化。由于初始化向量是一个随机量，所以在对两个明文加密过程中使用了同一初始化向量的概率是很小的。

在对第一个明文分组加密之前，将初始化向量与第一个明文分组进行异或运算，对运算结果进行加密，得到第一个密文分组。在对第一个密文分组进行解密之后，将解密结果与初始化向量进行异或运算，运算结果即为第一个明文分组。其余步骤与前述相同。在使用初始化向量后，完全相同的明文将被加密为不同的密文。初始化向量本身并不需要保密，它可以明文形式与密文一起发送和接收。
### 3)密文反馈（CFB，Cipher feedback）
并不是所有的应用程序都是工作在数据分组之上的，在面向字符流等的应用场合中同样存在着安全需求。在这些场合中我们必需使用流密码，CFB模式即满足了这种需要。在CFB模式下明文可以对比分组小得多的单元进行加密，假设明文分组长度为64比特，加密单元长度为8比特。CFB模式下的分组算法对输入的明文分组队列进行加密。首先，该队列就像在CBC模式下一样用一个初始化向量进行队首填充，然后对队列进行加密，加密后最左端的8比特与明文最初8比特进行异或运算，生成密文的最初8比特，并传送出去。这8比特被移至队列的最右端，然后其它位向左移动8比特，依此类推。解密过程与加密过程相反。
### 4)输出反馈模式（Output feedback, OFB）
OFB 模式与CFB 模式极为相似，它们之间唯一的不同之处就是，在CFB模式下密文被反馈至加密过程的下一步，而在OFB模式中对初始化向量的加密被反馈至加密过程的下一步(见图4)。除此之外，所有适用于CFB模式的细节皆可应用于OFB模式。
